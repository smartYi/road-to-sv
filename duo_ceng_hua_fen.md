# 多层划分

多层划分法，本质上还是分而治之的思想，因为元素范围很大，不能利用直接寻址表，所以通过多次划分，逐步确定范围，然后最后在一个可以接受的范围内进行。

## 问题实例

> `2.5`亿个整数中找出不重复的整数的个数，内存空间不足以容纳这`2.5`亿个整数

分析：有点像鸽巢原理，整数个数为`2^32`,也就是，我们可以将这`2^32`个数，划分为`2^8`个区域(比如用单个文件代表一个区域)，然后将数据分离到不同的区域，然后不同的区域在利用`bitmap`就可以直接解决了。也就是说只要有足够的磁盘空间，就可以很方便的解决。

> `5`亿个`int`找它们的中位数

分析：首先我们将`int`划分为`2^16`个区域，然后读取数据统计落到各个区域里的数的个数，之后我们根据统计结果就可以判断中位数落到那个区域，同时知道这个区域中的第几大数刚好是中位数。然后第二次扫描我们只统计落在这个区域中的那些数就可以了。

实际上，如果不是`int`是`int64`，我们可以经过`3`次这样的划分即可降低到可以接受的程度。即可以先将`int64`分成`2^24`个区域，然后确定区域的第几大数，在将该区域分成`2^20`个子区域，然后确定是子区域的第几大数，然后子区域里的数的个数只有`2^20`，就可以直接利用`direct addr table`进行统计了。